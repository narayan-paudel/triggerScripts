#!/usr/bin/env python


import os
import sys
from I3Tray import I3Tray, I3Units
from icecube.simprod import segments
from icecube.simprod.util import simprodtray, arguments
from icecube.simprod.util import ReadI3Summary, WriteI3Summary
from icecube import icetray, dataclasses, dataio, icetop_Level3_scripts, radcube
from icecube.simprod.util.simprodtray import RunI3Tray
import argparse
import icecube.icetray
import math
from icecube import phys_services, sim_services
from icecube import tableio, hdfwriter
from icecube.simprod.util import PrintContext
from icecube import topeventcleaning, tpx


import numpy as np

from icecube.weighting.fluxes import GaisserH4a_IT
from icecube.weighting.weighting import icetop_mc_weights

# weight_file = "/data/ana/CosmicRay/IceTop_level3/sim/L3_MC_incomplete_test/output/dataset_info.json"
# weight_file = "/home/enpaudel/icecube/triggerStudy/simFiles/dataset_info_partUneven.json" #my sim json file
# weight_file = "/home/enpaudel/icecube/triggerStudy/simFiles/dataset_info_100.json" #my sim json file
# weight_file = "/home/enpaudel/icecube/triggerStudy/simFiles/dataset_info_10.json" #my sim json file
weight_file = "/home/enpaudel/icecube/triggerStudy/simFiles/dataset_info200Uneven.json" #my sim json file

exceptionTanks_HG = {39:62,26:62,67:64}
exceptionTanks_LG = {26:61,67:63}


CORSIKA_ID = "DAT059871"
outputDir = "/home/enpaudel/icecube/triggerStudy/simFilesTest/"

# GCD="/data/user/kath/testdata/GeoCalibDetectorStatus_2020.Run135057.Pass2_V0_Snow210305.i3.gz"
# GCD="/data/user/enpaudel/triggerStudy/simFiles/GeoCalibDetectorStatus_2020.Run135057.Pass2_V0_Snow210305.i3.gz"
GCD="/data/user/enpaudel/triggerStudy/simFiles/GeoCalibDetectorStatus_2020.Run135057.Pass2_V0_Snow210305NoSMTDOMSet.i3.gz"

f = dataio.I3File(GCD)
geoFrame = f.pop_frame()
while f.more() and not "I3Geometry" in geoFrame:
    geoFrame = f.pop_frame()

charge_threshold = 10**-3 #threshold for charges of afterpulse in units of vem
time_threshold = 10.0**6.0 #in units of ns

import argparse
parser = argparse.ArgumentParser()
parser.add_argument('input', type=str, nargs='+', default="/home/enpaudel/icecube/triggerStudy/simFiles/ITGenTest/FeDAT000001GenDet.i3.bz2", help='Input files after running detector.py.')
args = parser.parse_args()

#python triggerProcClean.py ../simFiles/dataSetUnique/FeDAT005775GenDetFiltProcUnique.i3.gz


fileName = args.input[0].split("/")[-1]
fileName = fileName.split(".")[0]
print(fileName)
print("inputs",args.input)


def eventFilter(frame):
	"""simple event filter"""
	if abs(frame["I3EventHeader"].event_id) % 100 > 10:
		return False

def doublePEvent(frame):
	"""simple event filter"""
	if abs(frame["I3EventHeader"].sub_event_id) == 1 and str(frame["I3EventHeader"].sub_event_stream) == "IceTopSplit":
		# print(abs(frame["I3EventHeader"].sub_event_id),str(frame["I3EventHeader"].sub_event_stream))
		print("double Event",abs(frame["I3EventHeader"].event_id))
		return True
	else:
		return False

doublePList = [ 24400 ,24444 ,24453 ,24487 ,26417 ,26430 ,26443 ,26449 ,26457 ,26478 ,26493 ,27409 ,27431 ,27436 ,27440 ,27441 ,27444 ,27475 ,27477 ,27486 ,27491 ,27492 ,27499 ,54426 ,54439 ,54456 ,55406 ,55472 ,56434 ,56482 ,56495 ,57433 ,57495 ,84433 ,84455 ,84456 ,86432 ,86489 ,114412 , 114420 , 114421 , 114432 , 114443 , 114445 , 114449 , 114468 , 114470 , 115480 , 116413 , 116423 , 116443 , 116456 , 116464 , 116467 , 116485 , 116492 , 144417 , 144419 , 144431 , 144445 , 144462 , 144465 , 144467 , 144488 , 145444 , 145463 , 145476 , 145497 , 146415 , 146420 , 174410 , 174419 , 174442 , 174446 , 174484 , 175436 , 175443 , 175455 , 175467 , 175480 , 175483 , 175493 , 175497 , 176405 , 176426 , 176431 , 176442 , 176453 , 176478 , 176490 , 178419 , 204404 , 204422 , 204426 , 204428 , 204440 , 204443 , 204446 , 204489 , 204496 , 205400 , 205407 , 205459 , 206410 , 206418 , 206446 , 206449 , 206456 , 206459 , 207417 , 207441 , 207445 , 207497 , 207499 , 234409 , 234416 , 234426 , 234435 , 234456 , 234464 , 235416 , 235419 , 235431 , 235447 , 235461 , 235462 , 235468 , 235469 , 235488 , 235493 , 264400 , 264401 , 264412 , 264413 , 264448 , 264451 , 264469 , 265409 , 265411 , 265421 , 265427 , 265437 , 265441 , 265442 , 265444 , 265448 , 265458 , 265461 , 265468 , 265473 , 265487 , 265497 , 266443 , 266445 , 266483 , 294418 , 294423 , 294450 , 294453 , 294469 , 294470 , 294471 , 294478 , 294493 , 295405 , 295406 , 295438 , 295439 , 295492 , 296402 , 296452 , 296479 , 324433 , 324460 , 324477 , 324487 , 325404 , 325413 , 325428 , 325451 , 325456 , 325490 , 325494 , 354410 , 354413 , 354444 , 354447 , 354453 , 355401 , 355402 , 355423 , 355425 , 355456 , 355481 , 357416 , 357417 , 357421 , 357435 , 357453 , 384407 , 384414 , 384416 , 384434 , 384466 , 384472 , 384478 , 385416 , 385420 , 385425 , 386437 , 386447 , 386479 , 414453 , 414473 , 414475 , 415439 , 415467 , 415488 , 415490 , 416418 , 416420 , 416460 , 416466 , 416471 , 416484 , 416498 , 418405 , 418484 , 418487 , 444423 , 444459 , 444486 , 444497 , 445404 , 445405 , 445414 , 445434 , 445449 , 445497 , 474460 , 476453 , 476461 , 504447 , 504449 , 504480 , 504482 , 504499 , 505400 , 505408 , 505432 , 505440 , 505442 , 505452 , 505462 , 505466 , 505479 , 505490 , 505498 , 535402 , 535437 , 535470 , 535480 , 537445 , 537478 , 537487 , 538482 , 538483 , 564422 , 564481 , 566401 , 566409 , 566451 , 566458 , 566470 , 566483 , 594442 , 594469 , 594477 , 595429 , 595443 , 595471 , 625402 , 625409 , 625413 , 625418 , 625425 , 625429 , 625448 , 625455 , 625456 , 625494 , 626401 , 626419 , 626433 , 626440 , 626451 , 626489 , 626491 , 654402 , 654404 , 654413 , 654474 , 655434 , 655458 , 655475 , 656406 , 656409 , 656466 , 656473 , 656484 , 657448 , 657461 , 657488 , 657490 , 657497 , 684416 , 684429 , 684433 , 684443 , 684450 , 684464 , 684482 , 684487 , 684490 , 684491 , 684499 , 714414 , 714421 , 714455 , 714456 , 744408 , 744458 , 744480 , 745402 , 745410 , 745411 , 745423 , 745426 , 745457 , 745459 , 745487 , 746460 , 746463 , 774447 , 774472 , 774487 , 774496 , 777420 , 777426 , 777450 , 777493 , 777494 , 804416 , 804432 , 804443 , 804491 , 805483 , 805494 , 805495 , 835410 , 835417 , 835436 , 835444 , 835456 , 835466 , 835476 , 835491 , 836411 , 836419 , 836436 , 836444 , 836451 , 836486 , 836495 , 836498 , 864459 , 864490 , 865418 , 865435 , 865444 , 865450 , 865480 , 865495 , 894411 , 894423 , 894455 , 894479 , 924405 , 924460 , 924464 , 924469 , 924470 , 924496 , 1074406, 1074444, 1074446, 1074467, 1074476, 1074489, 1104403, 1104446, 1104493, 1284411, 1284413, 1284420, 1284453, 1284461, 1314405, 1314418, 1314449, 1314468, 1314474, 1404404, 1404410, 1404430, 1494420, 1524416, 1524432, 1524475, 1524497, 1555492, 1704499, 1795402, 1824405, 1854406, 1854413, 1854431, 1854481, 1974409, 1974477, 1974493, 2004426, 2034427, 2034491, 2065467, 2094419, 2094437, 2125426, 2125430, 2125448, 2154403, 2154430, 2154458, 2154484, 2154485, 2154490, 2275423, 2275432, 2275480, 2275495, 2334431, 2334462, 2334494, 2335447, 2335459, 2335484, 2394403, 2424407, 2424434, 2695493, 2754472, 2754481, 2904492, 2934411, 2934414, 2934487, 3025408, 3025419, 3025425, 3025448, 3025470, 3235414, 3235422, 3235475, 3444461, 3535416, 3535459, 3535466, 3654413, 3654451, 3744402, 3744406, 3744414, 3744454, 3744469, 3744495, 3804408, 3804423, 3804454, 3804483, 3834410, 3834450, 3985456, 4075424, 4075499, 4165411, 4165478, 4284415, 4284456, 4284468, 4344423, 4344436, 4344455, 4344460, 4344471, 4344499, 4435407, 4526401, 4526403, 4526426, 4526431, 4554460, 4584453, 4614405, 4614412, 4614455, 4614469, 4614470, 4614487, 4614488, 4645434, 4704408, 4704459, 4855432, 4855440, 4855470, 4914445, 4975405, 4975415, 5004406, 5034420, 5034466, 5036461, 5036483, 5155442, 5184411, 5184415, 5184425, 5184479, 5184493, 5364402, 5364430, 5364432, 5364456, 5424427, 5454473, 5454483, 5454486, 5454497, 5516474, 5544441, 5575442, 5606446, 5606483, 5606484, 5634432, 5634435, 5634447, 5634448, 5665464, 5665494, 5785433, 5786435, 5786454, 5786482, 5786498, 5875403, 5875408, 5875435, 5875438, 5875489, 5904490, 5934411, 5934415, 5934423, 5934450, 5934451, 5934468, 5934473, 5934495, 5934499, 5964430, 5964471, 5964474, 5964495, 24223 ,24231 ,24241 ,24253 ,24282 ,24293 ,25279 ,26215 ,26241 ,26268 ,26275 ,26290 ,27219 ,54215 ,54228 ,55219 ,55255 ,84209 ,84216 ,84261 ,84276 ,84285 ,85224 ,85255 ,85258 ,115240 , 115282 , 115288 , 115289 , 116207 , 116209 , 116259 , 116261 , 116265 , 116275 , 116282 , 116296 , 116297 , 144203 , 144224 , 144263 , 144284 , 145200 , 145205 , 145216 , 145226 , 145261 , 145278 , 145295 , 147292 , 174232 , 174254 , 174275 , 175215 , 175218 , 175229 , 175230 , 175247 , 175276 , 176202 , 176209 , 176233 , 177200 , 177203 , 177234 , 177242 , 177247 , 177249 , 177263 , 177265 , 177270 , 177277 , 177286 , 177288 , 204243 , 204281 , 204284 , 205227 , 205244 , 205246 , 206211 , 206239 , 206266 , 206274 , 206279 , 206295 , 234239 , 234256 , 234271 , 235216 , 235230 , 235270 , 235288 , 235289 , 236229 , 236265 , 236273 , 236299 , 237237 , 237248 , 237256 , 237283 , 237284 , 264221 , 264227 , 264236 , 264237 , 264261 , 264273 , 265292 , 266209 , 266230 , 267217 , 267296 , 294262 , 295215 , 295220 , 295251 , 295252 , 295258 , 295259 , 295270 , 295295 , 296200 , 296209 , 296234 , 296238 , 296254 , 296295 , 297239 , 324256 , 325222 , 325244 , 325284 , 325288 , 326284 , 327243 , 327271 , 327273 , 327278 , 327298 , 328227 , 328229 , 328241 , 354208 , 354225 , 354280 , 355215 , 355274 , 356210 , 356220 , 356240 , 356251 , 356259 , 356275 , 356299 , 384207 , 384209 , 384241 , 384278 , 385205 , 385213 , 385233 , 385238 , 385258 , 385274 , 385297 , 386221 , 387203 , 387205 , 387239 , 387264 , 387278 , 387294 , 414215 , 414234 , 414256 , 414257 , 414276 , 414279 , 416258 , 416277 , 416293 , 417230 , 417263 , 446213 , 446221 , 446231 , 474215 , 474268 , 476244 , 476267 , 476292 , 477239 , 477243 , 477260 , 477261 , 477262 , 477277 , 477278 , 477292 , 477298 , 504237 , 504242 , 504255 , 504279 , 504292 , 505215 , 505226 , 505263 , 505266 , 505269 , 506204 , 506205 , 506210 , 506228 , 506270 , 506282 , 507209 , 507226 , 507241 , 507244 , 507275 , 507283 , 534257 , 535203 , 535209 , 535222 , 535251 , 535289 , 535291 , 536201 , 536223 , 536231 , 536240 , 536259 , 536269 , 536293 , 536299 , 537240 , 537244 , 564200 , 564202 , 564258 , 564280 , 565204 , 565240 , 565244 , 565262 , 565295 , 566216 , 566220 , 566225 , 566230 , 566251 , 566286 , 594248 , 594299 , 596200 , 596209 , 596241 , 596253 , 596259 , 596260 , 596266 , 596278 , 596298 , 597200 , 597207 , 597208 , 597222 , 597239 , 597241 , 597291 , 597293 , 598274 , 598283 , 1524221, 1525217, 1554254, 1585217, 1585218, 1585252, 1585264, 1585279, 1614214, 1615216, 1615284, 1645270, 1645295, 1704213, 1704292, 1704294, 1705211, 1734257, 1734277, 1764211, 1764240, 1764287, 1764298, 1765216, 1795204, 1795252, 1855202, 1855225, 1855260, 1914218, 2004232, 2004254, 2004273, 2004296, 2064204, 2064279, 2094243, 2094262, 2095263, 2125215, 2125217, 2125264, 2155254, 2184219, 2184240, 2184261, 2184263, 2184292, 2184294, 2274216, 2364269, 2424241, 2605210, 2605243, 2784283, 2965202, 2965213, 2965219, 3054231, 3054253, 3054262, 3054263, 3054265, 3054273, 3084206, 3115230, 3115240, 3115268, 3115273, 3234262, 3295259, 3324297, 3414252, 3414289, 3444201, 3534214, 3564218, 3564240, 3564245, 3564251, 3564282, 3594200, 3595211, 3595240, 3595243, 3655250, 3684200, 3684219, 3685257, 3685281, 3685295, 3804213, 3804218, 3804236, 3804243, 3804296, 3834204, 3834263, 3865232, 3865245, 3865252, 3865254, 3865271, 3865284, 3924264, 3925204, 3925207, 3925241, 3925249, 3925279, 3954226, 3954249, 3954263, 3985227, 3985272, 4045244, 4045273, 4045297, 4164290, 4195259, 4195286, 4224243, 4224247, 4224251, 4224266, 4224269, 4224277, 4225228, 4225237, 4225242, 4255204, 4255219, 4255250, 4255262, 4314242, 4314248, 4314278, 4314289, 4405273, 4405294, 4434270, 4465210, 4465215, 4495244, 4495250, 4495261, 4495298, 4554239, 4554297, 4584215, 4584234, 4584283, 4584288, 4617262, 4675212, 4736223, 4765219, 4765220, 4765221, 4765289, 4765290, 4824207, 4824240, 4824252, 4824265, 4824266, 4824274, 4917234, 4974203, 5034297, 5155228, 5155244, 5155269, 5156251, 5156282, 5184217, 5184260, 5184278, 5214264, 5217217, 5217229, 5276220, 5305262, 5305279, 5335249, 5396214, 5396258, 5424203, 5424221, 5424281, 5424291, 5456257, 5456292, 5456295, 5484235, 5514239, 5664211, 5727249, 5727263, 5755294, 5844226, 5844241, 5844298, 5874240, 5874249, 5874261, 5877238, 5877292, 5904286, 5935298, 5994221, 5994248, 5994263, 5995201, 5995257, 5995259, 5997267, 24326 ,24352 ,24366 ,24390 ,25308 ,25379 ,25399 ,26301 ,26342 ,54376 ,54399 ,84328 ,84358 ,84362 ,84393 ,115302 , 115304 , 115317 , 115349 , 115350 , 116312 , 116320 , 116321 , 116326 , 116342 , 116343 , 116357 , 116369 , 116387 , 116395 , 144320 , 144326 , 144371 , 144376 , 144388 , 145353 , 145365 , 145366 , 145376 , 145388 , 147315 , 147359 , 147372 , 147386 , 175322 , 175352 , 175395 , 176327 , 176335 , 178302 , 178325 , 178330 , 178350 , 178355 , 178381 , 204306 , 204345 , 205384 , 205395 , 206311 , 206337 , 206338 , 206355 , 206364 , 206393 , 207307 , 207331 , 207382 , 234302 , 234304 , 234311 , 234313 , 234321 , 234335 , 234357 , 234391 , 234392 , 235311 , 235317 , 235332 , 235336 , 235360 , 236319 , 236371 , 236384 , 265302 , 266342 , 266354 , 266398 , 294319 , 294337 , 294388 , 294398 , 295313 , 295318 , 295338 , 295392 , 296381 , 324357 , 324384 , 326320 , 326341 , 326361 , 326387 , 327322 , 327376 , 328339 , 328347 , 354330 , 354379 , 354392 , 384301 , 384319 , 384353 , 384379 , 384382 , 384394 , 385310 , 385320 , 385332 , 385358 , 385372 , 414313 , 414322 , 414372 , 415373 , 415391 , 417334 , 418304 , 418330 , 418351 , 444326 , 445307 , 445384 , 446307 , 446311 , 446341 , 447311 , 474321 , 474369 , 474379 , 475318 , 475333 , 475359 , 504302 , 504317 , 504339 , 504367 , 504372 , 504396 , 505321 , 505322 , 505323 , 505326 , 505335 , 505339 , 506336 , 506347 , 506351 , 506358 , 506370 , 506378 , 534301 , 534313 , 534324 , 534373 , 536303 , 536377 , 536378 , 564307 , 564321 , 564329 , 564340 , 564370 , 564377 , 564380 , 564390 , 564394 , 565300 , 565324 , 565343 , 565379 , 566353 , 567312 , 567313 , 567367 , 567368 , 567397 , 594308 , 594328 , 594344 , 594377 , 594394 , 1795335, 1825308, 1825323, 1884305, 1884325, 1884345, 1884369, 1884374, 1884383, 1885318, 1885339, 1915399, 1974320, 1974353, 2004308, 2004327, 2004338, 2004343, 2004344, 2064316, 2064389, 2064390, 2064398, 2124300, 2125315, 2125358, 2125386, 2184345, 2184346, 2184366, 2184383, 2244376, 2244378, 2244397, 2395307, 2395316, 2395354, 2395390, 2395398, 2454301, 2454332, 2454358, 2544362, 2574301, 2574302, 2574303, 2574310, 2574374, 2604380, 2605350, 2605354, 2634346, 2664310, 2724373, 2724391, 2755304, 2755322, 2755380, 2935318, 2935392, 2964304, 2964312, 2964323, 2994339, 3084311, 3084319, 3084360, 3084389, 3085325, 3085353, 3085355, 3115319, 3115338, 3174301, 3174323, 3174326, 3174331, 3174353, 3235388, 3294372, 3355326, 3444361, 3444374, 3444375, 3445312, 3445333, 3445343, 3474314, 3475370, 3534308, 3534347, 3534367, 3534399, 3654315, 3655316, 3684319, 3684337, 3744391, 3774304, 3774308, 3774326, 3774341, 3774389, 3774391, 3864315, 3864360, 3864369, 3894313, 3894389, 3954344, 4044327, 4074324, 4074344, 4074385, 4165387, 4284300, 4284317, 4284322, 4314310, 4314379, 4314385, 4405316, 4405380, 4405387, 4435307, 4524317, 4524328, 4524367, 4524397, 4554325, 4554331, 4585361, 4585399, 4676380, 4735379, 4735394, 4916385, 5094324, 5094342, 5094374, 5094395, 5154368, 5186341, 5215332, 5215393, 5304311, 5304313, 5304354, 5304369, 5304377, 5305378, 5394393, 5454322, 5454329, 5454366, 5454379, 5454391, 5455395, 5755393, 5755397, 5814305, 5814313, 5814315, 5814328, 5814336, 5814354, 5814355, 5814362, 5904395, 5994308, 5994340, 24133 ,25106 ,25129 ,25139 ,25145 ,25147 ,25161 ,25173 ,25174 ,25189 ,26115 ,26118 ,26125 ,26158 ,26159 ,26182 ,26198 ,28100 ,28139 ,28161 ,28185 ,29108 ,29131 ,29135 ,29160 ,29184 ,29185 ,29194 ,29195 ,29196 ,54103 ,54108 ,54110 ,54116 ,54144 ,54148 ,54159 ,54168 ,54177 ,54188 ,54189 ,54194 ,55108 ,55173 ,55176 ,55189 ,56115 ,56131 ,56165 ,56168 ,56172 ,56180 ,84131 ,85101 ,85188 ,87143 ,114104 , 114172 , 115106 , 115109 , 115131 , 115145 , 115156 , 115157 , 115160 , 115171 , 115174 , 115182 , 115188 , 115195 , 115197 , 116108 , 116115 , 116123 , 116131 , 116136 , 116141 , 116148 , 116188 , 117100 , 117107 , 117123 , 117125 , 117143 , 117145 , 117161 , 117164 , 117177 , 117197 , 118105 , 118121 , 118124 , 118127 , 118130 , 118135 , 118144 , 118197 , 144110 , 144113 , 144125 , 144180 , 144199 , 145104 , 145135 , 145138 , 145172 , 145180 , 145182 , 146104 , 146105 , 146125 , 146130 , 146154 , 146156 , 146164 , 146175 , 146186 , 146194 , 174112 , 174130 , 174131 , 174140 , 174156 , 174163 , 174167 , 174182 , 175102 , 175118 , 175125 , 175171 , 175173 , 175174 , 175177 , 176167 , 176182 , 176195 , 176196 , 204153 , 204186 , 204199 , 205108 , 205112 , 205116 , 205131 , 205143 , 205169 , 205173 , 205176 , 205178 , 205193 , 206103 , 206110 , 206119 , 234116 , 234133 , 234136 , 234147 , 234149 , 234153 , 234169 , 234173 , 235105 , 235121 , 235141 , 235192 , 236101 , 236133 , 236146 , 236196 , 237110 , 237112 , 237132 , 237140 , 237144 , 237147 , 237161 , 237165 , 237179 , 237187 , 264128 , 264165 , 264180 , 265143 , 265199 , 266142 , 267113 , 267140 , 267151 , 267158 , 267170 , 267188 , 267194 , 294175 , 295121 , 295125 , 295143 , 295156 , 296118 , 296123 , 296129 , 296141 , 296155 , 296173 , 296175 , 296177 , 296180 , 296186 , 296192 , 297167 , 297178 , 324109 , 325139 , 325172 , 328111 , 328120 , 328133 , 328139 , 328140 , 328163 , 328179 , 328184 , 328188 , 328189 , 328198 , 354108 , 354113 , 354131 , 354179 , 354183 , 355108 , 355134 , 355140 , 355170 , 356102 , 356117 , 356120 , 356145 , 356149 , 356164 , 356181 , 384114 , 384122 , 384144 , 384149 , 384171 , 385119 , 385143 , 385145 , 385155 , 385162 , 385184 , 385198 , 386100 , 386108 , 386109 , 386121 , 386138 , 386153 , 386155 , 386196 , 388118 , 388141 , 388145 , 388158 , 388164 , 388167 , 414102 , 414126 , 414139 , 414157 , 414161 , 414162 , 414183 , 414185 , 414186 , 414193 , 415106 , 415140 , 415144 , 415177 , 415183 , 416105 , 416118 , 416124 , 416129 , 416149 , 416175 , 416177 , 416180 , 416182 , 416187 , 417125 , 417127 , 417140 , 418109 , 418110 , 418135 , 418140 , 418145 , 418155 , 418165 , 418173 , 418179 , 444108 , 444135 , 444148 , 444152 , 444177 , 444185 , 445108 , 445142 , 445145 , 445164 , 445169 , 445181 , 445184 , 446192 , 447116 , 447134 , 447145 , 447147 , 447180 , 474131 , 476126 , 476192 , 504107 , 504114 , 504175 , 504181 , 505116 , 505122 , 505124 , 505132 , 505185 , 505189 , 505194 , 506110 , 506165 , 507110 , 534120 , 534187 , 536122 , 536127 , 536129 , 536143 , 536144 , 536174 , 536180 , 536182 , 536187 , 565112 , 565114 , 565124 , 565132 , 565138 , 565143 , 565165 , 565174 , 565176 , 565195 , 566128 , 566174 , 566198 , 567123 , 567184 , 567193 , 595122 , 595126 , 595146 , 595166 , 595177 , 596100 , 596105 , 596122 , 596123 , 596153 , 596165 , 596177 , 597103 , 597119 , 597120 , 597126 , 597142 , 597161 , 597163 , 597173 , 597176 , 624139 , 624152 , 624156 , 624158 , 624169 , 624178 , 624192 , 684108 , 684136 , 684155 , 684181 , 714131 , 714178 , 744108 , 744143 , 744155 , 744186 , 774110 , 774124 , 774129 , 774136 , 774172 , 804102 , 804140 , 804142 , 804148 , 804170 , 804172 , 834114 , 1614104, 1614177, 1674118, 1674142, 1674143, 1674151, 1674164, 1704110, 1704131, 1824158, 1824161, 1824171, 1824186, 1884103, 1884140, 1884166, 1884180, 1884194, 1914103, 1914143, 1914155, 1944117, 1944118, 1944175, 1944180, 1974136, 2004107, 2004119, 2004171, 2004185, 2034112, 2094132, 2094169, 2094182, 2124114, 2124121, 2124125, 2124136, 2124144, 2124197, 2154104, 2184165, 2214102, 2274126, 2274139, 2304189, 2334104, 2334106, 2334125, 2364106, 2364173, 2394116, 2394129, 2394165, 2394168, 2394183, 2424107, 2424112, 2424113, 2424141, 2424145, 2424156, 2424160, 2424184, 2424196, 2454101, 2454108, 2454128, 2454143, 2454162, 2454167, 2454168, 2454193, 2484107, 2484108, 2484142, 2484156, 2484173, 2484177, 2484178, 2484183, 2484198, 2544150, 2574103, 2574123, 2574127, 2574132, 2574158, 2574190, 2574191, 2604156, 2604193, 2604194, 2604197, 2634107, 2634148, 2634150, 2634157, 2694128, 2694162, 2754102, 2754104, 2754157, 2754178, 2754182, 2754185, 2754193, 2844147, 2844176, 2844179, 2844183, 2844199, 2874101, 2874119, 2874157, 2874166, 2874178, 2874199, 2964101, 2964132, 2964137, 2964189, 2964195, 2964197, 2994148, 2994171, 2994196, 3024158, 3024185, 3024196, 3025173, 3025199, 3026120, 3026178, 3026187, 3027106, 3027182, 3027191, 3054105, 3054113, 3054115, 3054122, 3054132, 3054138, 3054149, 3054179, 3054189, 3055123, 3055126, 3055165, 3057193, 3084179, 3085103, 3086106, 3086109, 3086119, 3086129, 3086168, 3086188, 3086196, 3114182, 3114197, 3114198, 3115104, 3115109, 3115130, 3115151, 3115157, 3115169, 3115194, 3116168, 3116175, 3144133, 3144155, 3144161, 3144176, 3145122, 3145125, 3145194, 3145196, 3174107, 3174114, 3174144, 3174146, 3174152, 3174156, 3174162, 3174164, 3174173, 3174180, 3175103, 3175124, 3175141, 3175180, 3175194, 3175199, 3204191, 3205109, 3205137, 3205161, 3205196, 3206136, 3234102, 3234117, 3234161, 3234173, 3235134, 3235146, 3264119, 3264183, 3265119, 3265120, 3265141, 3265188, 3265192, 3265193, 3295102, 3295135, 3295148, 3295169, 3295170, 3324119, 3324124, 3324128, 3324158, 3324161, 3324172, 3324192, 3324194, 3325112, 3325133, 3325162, 3325185, 3326111, 3326194, 3354105, 3354116, 3354136, 3354149, 3354153, 3354158, 3354168, 3354180, 3354198, 3355102, 3355135, 3355165, 3355168, 3355187, 3384111, 3384197, 3385114, 3385123, 3385124, 3385184, 3414144, 3414166, 3414173, 3444199, 3445105, 3445185, 3474136, 3474147, 3474154, 3474167, 3474185, 3475145, 3476160, 3476191, 3504114, 3504115, 3504148, 3504171, 3504178, 3504191, 3504199, 3505161, 3534121, 3534124, 3534142, 3534153, 3534157, 3534166, 3534180, 3534183, 3536113, 3536145, 3536148, 3536167, 3536176, 3536193, 3564145, 3564161, 3565115, 3565120, 3565142, 3565178, 3565180, 3594126, 3594138, 3594153, 3594172, 3596119, 3597101, 3597112, 3597137, 3597139, 3597157, 3624110, 3624112, 3624128, 3624161, 3624177, 3624190, 3624192, 3626103, 3626116, 3626181, 3626183, 3654165, 3654174, 3714115, 3714121, 3714123, 3714177, 3744112, 3744130, 3744135, 3744150, 3744152, 3744165, 3744170, 3744188, 3744189, 3744197, 3744199, 3745123, 3745124, 3745154, 3745157, 3745166, 3745168, 3745178, 3745182, 3746180, 3775147, 3775154, 3775159, 3775167, 3804107, 3804179, 3804181, 3834131, 3835183, 3835198, 3836123, 3836138, 3865126, 3865129, 3865134, 3865180, 3865184, 3865189, 3894130, 3894192, 3895115, 3895134, 3895141, 3895160, 3895170, 3895197, 3895198, 3896122, 3896163, 3924181, 3927131, 3954137, 3954172, 3955157, 3955176, 3955177, 3984118, 4014152, 4016102, 4016176, 4016193, 4044127, 4044175, 4044178, 4044198, 4045111, 4045138, 4045139, 4046106, 4046116, 4046144, 4074118, 4074121, 4074135, 4074174, 4074177, 4074180, 4074188, 4105150, 4105167, 4105168, 4105172, 4105174, 4105187, 4105192, 4105197, 4106108, 4106135, 4106140, 4106171, 4134107, 4134113, 4134163, 4164104, 4164105, 4164106, 4164129, 4164149, 4164152, 4164161, 4164165, 4164171, 4165100, 4165138, 4166118, 4166122, 4166134, 4166154, 4167106, 4167112, 4167143, 4167146, 4167151, 4167190, 4167193, 4194120, 4194122, 4194135, 4195131, 4195136, 4195146, 4195153, 4224109, 4224120, 4224123, 4224139, 4224193, 4254105, 4254119, 4254139, 4254154, 4254183, 4255115, 4255121, 4255122, 4255178, 4284101, 4284114, 4284121, 4284137, 4284158, 4284159, 4284167, 4284173, 4284179, 4284184, 4285128, 4285133, 4285167, 4285172, 4314129, 4314136, 4314145, 4314155, 4314171, 4314174, 4314185, 4314193, 4314196, 4315107, 4315134, 4344119, 4344133, 4344148, 4344153, 4344179, 4344181, 4345122, 4345135, 4345151, 4345167, 4345178, 4345188, 4345194, 4347129, 4347154, 4347180, 4374103, 4374129, 4374175, 4374176, 4374190, 4375109, 4375171, 4375187, 4375192, 4404122, 4404154, 4404170, 4404172, 4404174, 4405111, 4405118, 4405123, 4405127, 4405158, 4434126, 4434131, 4434162, 4434175, 4434196, 4436144, 4436153, 4436157, 4464127, 4464141, 4464156, 4464197, 4465115, 4465126, 4465141, 4465147, 4465184, 4465186, 4466104, 4466131, 4466162, 4466174, 4466196, 4494104, 4494109, 4494168, 4494180, 4494193, 4494194, 4495134, 4495147, 4524100, 4524133, 4524138, 4524169, 4524179, 4524181, 4525141, 4525191, 4554102, 4554128, 4554129, 4554159, 4554193, 4555110, 4555112, 4555174, 4586100, 4586109, 4586128, 4586135, 4586144, 4586156, 4586158, 4586166, 4614187, 4614188, 4644135, 4644165, 4644172, 4644180, 4644184, 4645166, 4674118, 4674138, 4674144, 4674177, 4674179, 4674187, 4674188, 4675131, 4675143, 4675144, 4675175, 4704199, 4705122, 4705138, 4705149, 4705188, 4734108, 4734123, 4734136, 4734177, 4734188, 4735129, 4735163, 4735191, 4736101, 4736115, 4736121, 4736152, 4736196, 4764107, 4764109, 4764111, 4764124, 4764128, 4764134, 4764141, 4764195, 4765125, 4765186, 4794108, 4794109, 4795121, 4795124, 4795160, 4795184, 4796113, 4796188, 4797104, 4797119, 4797189, 4826117, 4826135, 4826146, 4826176, 4826181, 4826187, 4854116, 4854165, 4854188, 4856104, 4856116, 4856118, 4856128, 4856147, 4856169, 4856173, 4884128, 4884136, 4884147, 4884150, 4884158, 4884159, 4884188, 4885117, 4887109, 4887113, 4887116, 4887117, 4887137, 4887151, 4887198, 4914109, 4914169, 4914176, 4914197, 4915136, 4915153, 4944109, 4944138, 4944167, 4974105, 4974109, 4974146, 4974151, 4974178, 5004142, 5004154, 5005124, 5005136, 5005140, 5005144, 5005162, 5005173, 5005178, 5005182, 5005195, 5035122, 5035124, 5035133, 5035149, 5035152, 5035177, 5064103, 5064127, 5064168, 5064177, 5064178, 5064181, 5064183, 5064185, 5064198, 5065119, 5065162, 5065175, 5065196, 5094108, 5094143, 5095108, 5095113, 5095116, 5095123, 5095143, 5095146, 5095177, 5095178, 5097122, 5097134, 5097137, 5097159, 5125138, 5126124, 5184107, 5184120, 5184150, 5184170, 5184199, 5185101, 5185173, 5214115, 5214122, 5214123, 5214128, 5214157, 5214161, 5214172, 5217105, 5217117, 5217141, 5217166, 5217179, 5244164, 5244173, 5244177, 5245101, 5245103, 5245105, 5245133, 5245136, 5245148, 5245150, 5245160, 5245169, 5274122, 5274128, 5274129, 5274141, 5274142, 5274146, 5274185, 5274192, 5274195, 5275106, 5275113, 5275141, 5275142, 5275178, 5275191, 5304122, 5304145, 5304198, 5305108, 5305143, 5305198, 5364182, 5365107, 5365110, 5365147, 5365154, 5365167, 5366109, 5366112, 5366120, 5366134, 5366147, 5366163, 5366186, 5366187, 5394139, 5394140, 5394162, 5396127, 5396149, 5396188, 5424104, 5424119, 5424158, 5424162, 5425124, 5425126, 5425142, 5426108, 5426186, 5426191, 5426193, 5427165, 5456108, 5456109, 5456119, 5456122, 5456136, 5456168, 5456178, 5484145, 5484148, 5514160, 5514161, 5515102, 5515112, 5515119, 5515148, 5515149, 5515151, 5515157, 5515160, 5517153, 5517175, 5544101, 5544102, 5544124, 5544173, 5544180, 5546139, 5546192, 5574170, 5575110, 5575116, 5575142, 5575147, 5575172, 5576109, 5576194, 5604102, 5604105, 5604120, 5604124, 5604137, 5604154, 5604184, 5604192, 5634105, 5634112, 5634144, 5634153, 5634154, 5634159, 5664127, 5664148, 5664186, 5666105, 5666132, 5666178, 5666194, 5694108, 5694153, 5694166, 5724100, 5724106, 5724119, 5724141, 5724143, 5724191, 5726128, 5754135, 5784162, 5784169, 5784184, 5814105, 5814122, 5814190, 5815129, 5815143, 5817116, 5817128, 5817148, 5817151, 5817154, 5817160, 5817191, 5817195, 5844159, 5844192, 5844198, 5845148, 5845161, 5845195, 5846152, 5846154, 5846169, 5846170, 5846171, 5846184, 5846195, 5847157, 5874173, 5874194, 5876122, 5876129, 5876139, 5876155, 5876161, 5876164, 5876166, 5904123, 5934141, 5935104, 5935122, 5935162, 5936194, 5964108, 5964190, 5964196, 5994109, 5994115, 5994134, 5994172, 5994184, 5994192, 5995120, 5995121, 5995123, 5995127, 5995140, 5995144, 5995156, 5995158, 5995179, 5995190, 5995196]

def filtDoublePEvents(frame):
	if abs(frame["I3EventHeader"].event_id) in doublePList:
		return True
	else:
		return False




tray = I3Tray()
tray.AddModule("I3Reader","reader",
	           filenameList=[GCD]+args.input,
	           # streams=[icetray.I3Frame.DAQ,icetray.I3Frame.Physics],
	           # streams=[icetray.I3Frame.Geometry,icetray.I3Frame.Calibration, icetray.I3Frame.DetectorStatus]
	          )

# tray.AddModule(doublePEvent,"doubleP",
# 				streams=[icetray.I3Frame.DAQ,icetray.I3Frame.Physics]
# 				)
tray.AddModule(filtDoublePEvents,"doublePFilt",
				streams=[icetray.I3Frame.DAQ,icetray.I3Frame.Physics]
				)

tray.AddModule("I3Writer","i3writer",
	          # filename=str(outputDir)+"/hadronTimeTest/"+str(fileName)+"HadronNonTrigImProperTEvts.i3.gz",
	          # filename=str(outputDir)+"/dataSetCleanTestSeedSame/"+str(fileName)+"CleanVEMEvts.i3.gz",
	          filename=str(outputDir)+"/dataSetDoubleP/"+str(fileName)+"DoublePEvts.i3.gz",
	          # filename=str(outputDir)+"/dataSetCleanOfficial/"+str(fileName)+"CleanVEMEvts.i3.gz",
	          streams=[icetray.I3Frame.DAQ,icetray.I3Frame.Physics],
	          # streams=[icetray.I3Frame.DAQ,icetray.I3Frame.Physics],
	          # streams=[icetray.I3Frame.Geometry,icetray.I3Frame.Calibration, icetray.I3Frame.DetectorStatus]
	          )

tray.Execute()
tray.Finish()
